"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8396],{8396:(j,_,d)=>{d.r(_),d.d(_,{ChangeSchedulePageModule:()=>J});var g=d(6814),h=d(6223),a=d(451),u=d(8179),f=d(5861),m=d(9315),e=d(9212),x=d(6530),C=d(82);function y(t,s){1&t&&(e.TgZ(0,"ion-datetime",32)(1,"span",33),e._uU(2,"Select shift start time"),e.qZA()()),2&t&&e.Q6J("showDefaultTitle",!0)("showDefaultButtons",!0)}function v(t,s){1&t&&(e.TgZ(0,"ion-datetime",34)(1,"span",33),e._uU(2,"Select shift end time"),e.qZA()()),2&t&&e.Q6J("showDefaultTitle",!0)("showDefaultButtons",!0)}function Z(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",13)(1,"div",14)(2,"p",15),e._uU(3,"Please select a day and time range"),e.qZA()(),e.TgZ(4,"div",16)(5,"ion-radio-group",17),e.NdJ("ngModelChange",function(o){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedOption=o)}),e.TgZ(6,"ion-radio",18),e._uU(7,"Monday"),e.qZA(),e.TgZ(8,"ion-radio",19),e._uU(9,"Tuesday"),e.qZA(),e.TgZ(10,"ion-radio",20),e._uU(11,"Wednesday"),e.qZA(),e.TgZ(12,"ion-radio",21),e._uU(13,"Thursday"),e.qZA(),e.TgZ(14,"ion-radio",22),e._uU(15,"Friday"),e.qZA()()(),e.TgZ(16,"div",23)(17,"p",24),e._uU(18,"From"),e.qZA(),e._UZ(19,"ion-datetime-button",25),e.TgZ(20,"ion-modal",26),e.YNc(21,y,3,2,"ng-template"),e.qZA(),e.TgZ(22,"p",27),e._uU(23,"to"),e.qZA(),e._UZ(24,"ion-datetime-button",28),e.TgZ(25,"ion-modal",26),e.YNc(26,v,3,2,"ng-template"),e.qZA()(),e.TgZ(27,"div",29)(28,"ion-button",30),e.NdJ("click",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.dismiss())}),e._uU(29,"Cancel"),e.qZA(),e.TgZ(30,"ion-button",31),e.NdJ("click",function(){e.CHM(n);const o=e.oxw();return e.KtG(o.addShift())}),e._uU(31,"Add shift"),e.qZA()()()}if(2&t){const n=e.oxw();e.xp6(5),e.Q6J("ngModel",n.selectedOption),e.xp6(15),e.Q6J("keepContentsMounted",!0),e.xp6(5),e.Q6J("keepContentsMounted",!0)}}function P(t,s){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const n=e.oxw(2);e.xp6(),e.hij("",n.shifts.length," shift per week")}}function b(t,s){if(1&t&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&t){const n=e.oxw(2);e.xp6(),e.hij("",n.shifts.length," shifts per week")}}function T(t,s){if(1&t&&(e.TgZ(0,"ion-label"),e._uU(1),e.qZA()),2&t){const n=e.oxw().$implicit;e.xp6(),e.hij("",n.coverCount.coverRequestsCount," covers")}}function M(t,s){if(1&t){const n=e.EpF();e.TgZ(0,"div",40)(1,"div",41)(2,"p",42),e._uU(3),e.ALo(4,"date"),e.ALo(5,"date"),e.qZA(),e._UZ(6,"div",43),e.TgZ(7,"ion-chip",44),e.YNc(8,T,2,1,"ion-label",12),e.qZA(),e._UZ(9,"div",43),e.TgZ(10,"ion-chip",45)(11,"ion-label"),e._uU(12),e.qZA()()(),e.TgZ(13,"ion-icon",46),e.NdJ("click",function(){const r=e.CHM(n).$implicit,c=e.oxw(3);return e.KtG(c.deleteAlert(r.id))}),e.qZA()()}if(2&t){const n=s.$implicit;e.xp6(3),e.AsE("",e.xi3(4,4,n.shift.time_start,"h:mm")," - ",e.xi3(5,7,n.shift.time_end,"h:mm"),""),e.xp6(5),e.Q6J("ngIf",n.coverCount),e.xp6(4),e.hij("",n.missed_attendance," misses")}}function S(t,s){if(1&t&&(e.TgZ(0,"div")(1,"p",37),e._uU(2),e.qZA(),e.TgZ(3,"ion-card",38),e.YNc(4,M,14,10,"div",39),e.qZA()()),2&t){const n=s.$implicit,i=e.oxw(2);e.xp6(2),e.Oqu(n),e.xp6(2),e.Q6J("ngForOf",i.groupedShifts[n])}}function O(t,s){if(1&t&&(e.ynx(0),e.TgZ(1,"div",35)(2,"div",14),e.YNc(3,P,2,1,"p",12)(4,b,2,1,"p",12),e.qZA(),e.YNc(5,S,5,2,"div",36),e.qZA(),e.BQk()),2&t){const n=e.oxw();e.xp6(3),e.Q6J("ngIf",1===n.shifts.length),e.xp6(),e.Q6J("ngIf",n.shifts.length>1),e.xp6(),e.Q6J("ngForOf",n.sortedDays())}}function w(t,s){1&t&&(e.ynx(0),e.TgZ(1,"div",47),e._UZ(2,"ion-spinner",48),e.qZA(),e.BQk())}function A(t,s){1&t&&(e.ynx(0),e.TgZ(1,"div",47)(2,"div",14)(3,"p"),e._uU(4,"No shifts"),e.qZA(),e.TgZ(5,"p",49),e._uU(6,"This member's shifts will appear here"),e.qZA(),e._UZ(7,"ion-img",50),e.qZA()(),e.BQk())}function k(t,s){if(1&t&&(e.ynx(0),e.YNc(1,w,3,0,"ng-container",12)(2,A,8,0,"ng-container",12),e.BQk()),2&t){const n=e.oxw();e.xp6(),e.Q6J("ngIf",n.isLoading),e.xp6(),e.Q6J("ngIf",!n.isLoading)}}const U=[{path:"",component:(()=>{var t;class s{constructor(i,o,r,c,l,p,Q){this.userService=i,this.route=o,this.toastController=r,this.adminService=c,this.alertController=l,this.router=p,this.modalController=Q,this.userId="",this.groupedShifts={},this.selectedOption="monday",this.shifts=[],this.shiftsPastWeek=0,this.isLoading=!1}ngOnInit(){this.getUserShifts()}getUserShifts(){this.isLoading=!0,this.route.params.subscribe(i=>{this.userId=i.id,this.userService.getUserShifts(this.userId).subscribe(o=>{this.shifts=Object.values(o).reduce((c,l)=>c.concat(l),[]),this.groupedShifts=this.groupShiftsByDay(this.shifts);const r=this.shifts.map(c=>this.getShiftCoversCount(c.id));(0,m.D)(r).subscribe(c=>{c.forEach((l,p)=>{this.shifts[p].coverCount=l})},c=>{console.error("Error fetching shift covers count:",c)},()=>{this.isLoading=!1})},o=>{console.error("Error fetching user shifts:",o)})})}getShiftCoversCount(i){return this.adminService.getShiftCoversCount(this.userId,i)}groupShiftsByDay(i){return i.reduce((r,c)=>{const l=c.shift.day;return r[l]||(r[l]=[]),c.shift.time_start=new Date(`1970-01-01T${c.shift.time_start}`),c.shift.time_end=new Date(`1970-01-01T${c.shift.time_end}`),r[l].push(c),r},{})}sortedDays(){const i=["Monday","Tuesday","Wednesday","Thursday","Friday"];return Object.keys(this.groupedShifts).sort((o,r)=>i.indexOf(o)-i.indexOf(r))}addShift(){}deleteAlert(i){var o=this;return(0,f.Z)(function*(){yield(yield o.alertController.create({header:"Delete Shift?",subHeader:"Are you sure you want to permanently delete this shift?",cssClass:"alert-dialog",buttons:[{text:"Cancel",role:"cancel",cssClass:"alert-button-cancel"},{text:"Delete",cssClass:"alert-button-ok-red",handler:()=>{o.deleteShift(i)}}]})).present()})()}deleteShift(i){this.adminService.deleteShift(this.userId,i).subscribe({next:o=>{console.log("Deleted shift successfully:",o),this.presentToast("Shift deleted"),this.ngOnInit()},error:o=>{console.error("Error deleting shift:",o)}})}presentToast(i){var o=this;return(0,f.Z)(function*(){(yield o.toastController.create({message:i,duration:2e3,position:"bottom"})).present()})()}dismiss(){this.modalController.dismiss()}back(){var i=this;return(0,f.Z)(function*(){i.router.navigate(["./user-profile",i.userId])})()}}return(t=s).\u0275fac=function(i){return new(i||t)(e.Y36(x.K),e.Y36(u.gz),e.Y36(a.yF),e.Y36(C.l),e.Y36(a.Br),e.Y36(u.F0),e.Y36(a.IN))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-change-schedule"]],decls:17,vars:2,consts:[["id","main-content"],[1,"header-toolbar"],[1,"toolbar-container"],["slot","start"],[3,"click"],["name","chevron-back-outline",1,"back-button"],[1,"title"],["vertical","bottom","horizontal","end","slot","fixed"],["id","add-shift"],["name","add"],["mode","ios","id","add-shift-modal","trigger","add-shift"],["modal",""],[4,"ngIf"],[1,"wrapper"],[1,"stmt"],[1,"section"],[1,"weekdays-radio"],["mode","md",3,"ngModel","ngModelChange"],["value","monday","labelPlacement","stacked"],["value","tuesday","labelPlacement","stacked"],["value","wednesday","labelPlacement","stacked"],["value","thursday","labelPlacement","stacked"],["value","friday","labelPlacement","stacked"],[1,"time-frame-container"],[1,"from"],["datetime","from-date"],[3,"keepContentsMounted"],[1,"to"],["datetime","to-date"],[1,"buttons-container"],["fill","outline",1,"cancel-button",3,"click"],["fill","outline",1,"fetch-button",3,"click"],["presentation","time","id","from-date",3,"showDefaultTitle","showDefaultButtons"],["slot","title"],["presentation","time","id","to-date",3,"showDefaultTitle","showDefaultButtons"],[1,"body"],[4,"ngFor","ngForOf"],[1,"day"],[1,"shifts-card"],["class","shift-container",4,"ngFor","ngForOf"],[1,"shift-container"],[1,"shift"],[1,"time"],[1,"seperator"],["color","warning"],["color","danger"],["name","close-circle-outline",1,"delete-icon",3,"click"],[1,"body1"],["name","crescent"],[1,"second-stmt"],["src","assets/img/no-emergencies-img.png",1,"no-emergencies-img"]],template:function(i,o){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"div",2)(3,"ion-buttons",3)(4,"ion-button",4),e.NdJ("click",function(){return o.back()}),e._UZ(5,"ion-icon",5),e.qZA()(),e.TgZ(6,"ion-title",6),e._uU(7,"Editing Schedule"),e.qZA()()()(),e.TgZ(8,"ion-content")(9,"ion-fab",7)(10,"ion-fab-button",8),e._UZ(11,"ion-icon",9),e.qZA()(),e.TgZ(12,"ion-modal",10,11),e.YNc(14,Z,32,3,"ng-template"),e.qZA(),e.YNc(15,O,6,3,"ng-container",12)(16,k,3,2,"ng-container",12),e.qZA()),2&i&&(e.xp6(15),e.Q6J("ngIf",o.shifts.length>0),e.xp6(),e.Q6J("ngIf",0==o.shifts.length))},dependencies:[g.sg,g.O5,h.JJ,h.On,a.YG,a.Sm,a.PM,a.hM,a.W2,a.x4,a.Mj,a.IJ,a.W4,a.Gu,a.gu,a.Xz,a.Q$,a.B7,a.se,a.PQ,a.wd,a.sr,a.ki,a.U5,a.QI,g.uU],styles:[".header-toolbar[_ngcontent-%COMP%]{height:60px;display:flex;justify-content:center;align-items:center}.toolbar-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding:5px}.back-button[_ngcontent-%COMP%]{font-weight:400}.title[_ngcontent-%COMP%]{font-size:22px;font-weight:400}.save-button[_ngcontent-%COMP%]{width:20%;font-size:30px}.save-button[_ngcontent-%COMP%]:active{color:gray}.body[_ngcontent-%COMP%]{display:flex;flex-direction:column}.day-container[_ngcontent-%COMP%]{margin-bottom:1.5em}.day[_ngcontent-%COMP%]{margin:0;padding-left:10px}.shifts-card[_ngcontent-%COMP%]{margin-top:10px;border:1px solid lightgray;padding-top:5px;padding-bottom:5px}.shift-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-evenly;flex-direction:row}.shift[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-evenly;flex-direction:row;border-radius:10px;border:1px solid lightgray;height:3em;width:85%;margin:5px}.seperator[_ngcontent-%COMP%]{background-color:#d3d3d3;height:100%;width:1.5px}.delete-icon[_ngcontent-%COMP%]{font-size:25px}.delete-icon[_ngcontent-%COMP%]:active{color:gray}ion-fab-button[_ngcontent-%COMP%]{--background: #810808;--background-activated: #380404;--color: white;margin:5px}ion-modal#add-shift-modal[_ngcontent-%COMP%]{--width: 96%;--min-width: 250px;--height: fit-content;--border-radius: 6px;--box-shadow: 0 28px 48px rgba(0, 0, 0, .4)}ion-modal#add-shift-modal[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.stmt[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:18px;font-weight:700}ion-radio-group[_ngcontent-%COMP%]{padding:10px}ion-radio[_ngcontent-%COMP%]{--color-checked: #810808}.weekdays-radio[_ngcontent-%COMP%]{margin-top:1em}.time-frame-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-evenly;margin:1.5em}.from[_ngcontent-%COMP%], .to[_ngcontent-%COMP%]{padding-right:5px}.to[_ngcontent-%COMP%]{padding-left:5px}.buttons-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:10px;width:100%}.fetch-button[_ngcontent-%COMP%]{--border-color: #810808;--background-activated: #810808;--color-activated: white;width:50%}.cancel-button[_ngcontent-%COMP%]{--background-activated: #810808;--color-activated: white;width:50%}.body1[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-evenly;margin-top:5em;padding:10px}.stmt[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-top:1em;font-size:18px;font-weight:700}.second-stmt[_ngcontent-%COMP%]{margin-top:-1em;font-size:14px;text-align:center}.no-emergencies-img[_ngcontent-%COMP%]{width:80%}.no-results[_ngcontent-%COMP%]{font-style:italic}"]}),s})()}];let q=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.Bz.forChild(U),u.Bz]}),s})(),J=(()=>{var t;class s{}return(t=s).\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[g.ez,h.u5,a.Pc,q]}),s})()}}]);