"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7664],{7664:(D,d,r)=>{r.r(d),r.d(d,{AnnouncementsPageModule:()=>B});var g=r(6814),x=r(6223),a=r(451),_=r(8179),n=r(9212),h=r(6530);const A=["modal"];function v(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"ion-chip",21),n._uU(2),n.qZA(),n.BQk()),2&e){const t=n.oxw().$implicit;n.xp6(2),n.Oqu(t.importance)}}function Z(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"ion-chip",22),n._uU(2),n.qZA(),n.BQk()),2&e){const t=n.oxw().$implicit;n.xp6(2),n.Oqu(t.importance)}}function P(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"ion-chip",23),n._uU(2),n.qZA(),n.BQk()),2&e){const t=n.oxw().$implicit;n.xp6(2),n.Oqu(t.importance)}}function y(e,o){if(1&e&&(n.TgZ(0,"div")(1,"h3",18),n._uU(2),n.qZA()()),2&e){const t=n.oxw().$implicit;n.xp6(2),n.gL8(" Sent to ",1==t.visible_to?"dispatchers":""," ",2==t.visible_to?"medics":""," ",3==t.visible_to?"admins":""," ",4==t.visible_to?"medics & admins":""," ",5==t.visible_to?"dispatchers & admins":""," ",6==t.visible_to?"dispatchers & medics":""," ")}}function b(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"ion-chip",21),n._uU(2),n.qZA(),n.BQk()),2&e){const t=n.oxw(4);n.xp6(2),n.Oqu(t.selectedAnnouncement.importance)}}function M(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"ion-chip",22),n._uU(2),n.qZA(),n.BQk()),2&e){const t=n.oxw(4);n.xp6(2),n.Oqu(t.selectedAnnouncement.importance)}}function T(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"ion-chip",23),n._uU(2),n.qZA(),n.BQk()),2&e){const t=n.oxw(4);n.xp6(2),n.Oqu(t.selectedAnnouncement.importance)}}function O(e,o){if(1&e&&(n.TgZ(0,"div",24)(1,"div",25)(2,"div",9)(3,"ion-avatar",10),n._UZ(4,"img",11),n.qZA()(),n.TgZ(5,"div",12)(6,"div",13)(7,"h2",14),n._uU(8),n.qZA(),n.YNc(9,b,3,1,"ng-container",5)(10,M,3,1,"ng-container",5)(11,T,3,1,"ng-container",5),n.qZA(),n.TgZ(12,"div",15)(13,"p",16),n._uU(14),n.qZA()(),n.TgZ(15,"div",17)(16,"h3",18),n._uU(17),n.qZA()()()()()),2&e){const t=n.oxw().$implicit,i=n.oxw(2);n.xp6(8),n.AsE("",i.selectedAnnouncement.admin.first_name," ",i.selectedAnnouncement.admin.last_name,""),n.xp6(),n.Q6J("ngIf","Very important"==t.importance),n.xp6(),n.Q6J("ngIf","Important"==t.importance),n.xp6(),n.Q6J("ngIf","Regular"==t.importance),n.xp6(3),n.Oqu(i.selectedAnnouncement.description),n.xp6(3),n.Oqu(i.formatDate(i.selectedAnnouncement.created_at))}}function w(e,o){if(1&e){const t=n.EpF();n.TgZ(0,"div",8),n.NdJ("click",function(){const c=n.CHM(t).$implicit,m=n.oxw(2);return n.KtG(m.openModal(c))}),n.TgZ(1,"div",9)(2,"ion-avatar",10),n._UZ(3,"img",11),n.qZA()(),n.TgZ(4,"div",12)(5,"div",13)(6,"h2",14),n._uU(7),n.qZA(),n.YNc(8,v,3,1,"ng-container",5)(9,Z,3,1,"ng-container",5)(10,P,3,1,"ng-container",5),n.qZA(),n.TgZ(11,"div",15)(12,"p",16),n._uU(13),n.qZA()(),n.TgZ(14,"div",17),n.YNc(15,y,3,6,"div",5),n.TgZ(16,"h3",18),n._uU(17),n.qZA()()(),n.TgZ(18,"ion-modal",19,20),n.YNc(20,O,18,7,"ng-template"),n.qZA()()}if(2&e){const t=o.$implicit,i=n.oxw(2);n.xp6(7),n.AsE("",t.admin.first_name," ",t.admin.last_name,""),n.xp6(),n.Q6J("ngIf","Very important"==t.importance),n.xp6(),n.Q6J("ngIf","Important"==t.importance),n.xp6(),n.Q6J("ngIf","Regular"==t.importance),n.xp6(3),n.hij(" ",i.truncateDescription(t.description,65)," "),n.xp6(2),n.Q6J("ngIf","Admin"==i.userRank||"Medic & Admin"==i.userRank||"Dispatcher & Admin"==i.userRank),n.xp6(2),n.hij(" \xa0",i.formatDate(t.created_at)," ")}}function C(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"div",6),n.YNc(2,w,21,8,"div",7),n.qZA(),n.BQk()),2&e){const t=n.oxw();n.xp6(2),n.Q6J("ngForOf",t.visibleAnnouncements)}}function k(e,o){1&e&&(n.ynx(0),n.TgZ(1,"div",26),n._UZ(2,"ion-spinner",27),n.qZA(),n.BQk())}function q(e,o){1&e&&(n.ynx(0),n.TgZ(1,"div",26)(2,"div",28)(3,"p"),n._uU(4,"No announcements"),n.qZA(),n.TgZ(5,"p",29),n._uU(6,"Announcements sent by board members will appear here"),n.qZA(),n._UZ(7,"ion-img",30),n.qZA()(),n.BQk())}function Q(e,o){if(1&e&&(n.ynx(0),n.YNc(1,k,3,0,"ng-container",5)(2,q,8,0,"ng-container",5),n.BQk()),2&e){const t=n.oxw();n.xp6(),n.Q6J("ngIf",t.isLoading),n.xp6(),n.Q6J("ngIf",!t.isLoading)}}const U=[{path:"",component:(()=>{var e;class o{constructor(i){this.userService=i,this.userId=localStorage.getItem("user_id"),this.userRank=localStorage.getItem("rank"),this.announcements=[],this.visibleAnnouncements=[],this.isLoading=!1}ngOnInit(){this.getAllAnnouncements()}getAllAnnouncements(){this.isLoading=!0,this.userService.getAllAnnouncements().subscribe({next:i=>{if(i&&i.hasOwnProperty("announcements")){console.log("Fetched all announcements: ",i);const s=JSON.parse(JSON.stringify(i));this.announcements=[].concat.apply([],Object.values(s.announcements)),this.announcements.forEach(c=>{(1==c.visible_to||5==c.visible_to)&&"Medic"!=this.userRank&&this.visibleAnnouncements.push(c),(2==c.visible_to||4==c.visible_to)&&"Dispatcher"!=this.userRank&&this.visibleAnnouncements.push(c),3==c.visible_to&&("Admin"==this.userRank||"Medic & Admin"==this.userRank||"Dispatcher & Admin"==this.userRank)&&this.visibleAnnouncements.push(c),(6==c.visible_to||0==c.visible_to)&&this.visibleAnnouncements.push(c)})}else console.log("No announcements")},error:i=>{console.error("Error retrieving announcements:",i)},complete:()=>{this.isLoading=!1}})}truncateDescription(i,s){return i.length>s?i.slice(0,s)+"...":i}formatDate(i){const s=new Date,c=new Date(i),m=s.getTime()-c.getTime(),u=Math.round(m/6e4),p=Math.round(m/1e3),l=Math.round(u/60);if(p<60)return 1===p?"1 second ago":`${p} seconds ago`;if(u<60)return 1===u?"1 minute ago":`${u} minutes ago`;if(l<24)return 1===l?"1 hour ago":`${l} hours ago`;const f=Math.round(l/24);return 1===f?"1 day ago":`${f} days ago`}openModal(i){var s;this.selectedAnnouncement=i,null===(s=this.modal)||void 0===s||s.present()}}return(e=o).\u0275fac=function(i){return new(i||e)(n.Y36(h.K))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-announcements"]],viewQuery:function(i,s){if(1&i&&n.Gf(A,5),2&i){let c;n.iGM(c=n.CRH())&&(s.modal=c.first)}},decls:9,vars:2,consts:[["id","main-content"],[1,"toolbar"],["slot","start"],[1,"title"],[1,"background"],[4,"ngIf"],[1,"mainpage"],["class","announcement","id","announcement.id",3,"click",4,"ngFor","ngForOf"],["id","announcement.id",1,"announcement",3,"click"],[1,"first-box"],["slot","start",1,"profile-picture"],["alt","Silhouette of a person's head","src","https://ionicframework.com/docs/img/demos/avatar.svg"],[1,"second-box"],[1,"name"],[1,"username"],[1,"description-container"],[1,"description"],[1,"time-posted"],[1,"time"],["id","view-announcement-modal"],["modal",""],["color","danger"],["color","warning"],["color","success"],[1,"wrapper"],[1,"announcement"],[1,"body"],["name","crescent"],[1,"stmt"],[1,"second-stmt"],["src","assets/img/no-emergencies-img.png",1,"no-emergencies-img"]],template:function(i,s){1&i&&(n.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),n._UZ(3,"ion-menu-button"),n.qZA(),n.TgZ(4,"ion-title",3),n._uU(5,"Announcements"),n.qZA()()(),n.TgZ(6,"ion-content",4),n.YNc(7,C,3,1,"ng-container",5)(8,Q,3,2,"ng-container",5),n.qZA()),2&i&&(n.xp6(7),n.Q6J("ngIf",s.visibleAnnouncements.length>0),n.xp6(),n.Q6J("ngIf",0==s.visibleAnnouncements.length))},dependencies:[g.sg,g.O5,a.BJ,a.Sm,a.hM,a.W2,a.Gu,a.Xz,a.fG,a.PQ,a.wd,a.sr,a.ki],styles:[".toolbar[_ngcontent-%COMP%]{height:60px}ion-menu-button[_ngcontent-%COMP%]{font-weight:400;margin-top:12px}.title[_ngcontent-%COMP%]{font-size:22px;font-weight:400;margin-top:7px}.mainpage[_ngcontent-%COMP%]{display:flex;flex-direction:column}.announcement[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;border-bottom:1px solid gray}.announcement[_ngcontent-%COMP%]:active{opacity:.2}.first-box[_ngcontent-%COMP%]{flex-direction:row;display:flex;align-items:center;justify-content:center}.profile-picture[_ngcontent-%COMP%]{margin:15px;color:#837272;height:70px;width:70px}.second-box[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-right:10px;width:100%}.name[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.username[_ngcontent-%COMP%]{font-weight:700;font-size:18px}ion-chip[_ngcontent-%COMP%]{font-size:14px;height:50%;text-align:center;justify-content:space-between;align-items:flex-end;padding-right:10px}.ion-chip-critical[_ngcontent-%COMP%]{--background: #FF0000;--color: white}.ion-chip-important[_ngcontent-%COMP%]{--background: #FF7A00;--color: white}.ion-chip-regular[_ngcontent-%COMP%]{--background: #0BC813;--color: white}.time-posted[_ngcontent-%COMP%]{margin:0;display:flex}.time[_ngcontent-%COMP%]{opacity:.8;font-size:13px;font-weight:lighter;margin-top:10px;font-style:italic}.description[_ngcontent-%COMP%]{margin:0;opacity:.8}ion-modal#view-announcement-modal[_ngcontent-%COMP%]{--width: 96%;--min-width: 250px;--height: fit-content;--border-radius: 6px;--box-shadow: 0 28px 48px rgba(0, 0, 0, .4)}.body[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-evenly;margin-top:5em;padding:10px}.stmt[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding-top:1em;font-size:18px;font-weight:700}.second-stmt[_ngcontent-%COMP%]{margin-top:-1em;font-size:14px;text-align:center}.no-emergencies-img[_ngcontent-%COMP%]{width:80%}.no-results[_ngcontent-%COMP%]{font-style:italic}"]}),o})()}];let J=(()=>{var e;class o{}return(e=o).\u0275fac=function(i){return new(i||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[_.Bz.forChild(U),_.Bz]}),o})();var I=r(9862);let B=(()=>{var e;class o{}return(e=o).\u0275fac=function(i){return new(i||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({providers:[g.uU],imports:[g.ez,x.u5,I.JF,a.Pc,J]}),o})()}}]);