"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5331],{5331:(y,m,i)=>{i.r(m),i.d(m,{LoginPageModule:()=>v});var u=i(6814),a=i(451),g=i(6223),d=i(8179),p=i(5861),e=i(9212),h=i(2241),f=i(6401),P=i(8859);const b=[{path:"",component:(()=>{var n;class s{constructor(o,t,r,l,_){this.authService=o,this.router=t,this.toastController=r,this.appComponent=l,this.fcmService=_,this.selectedOption="SSF",this.password="",this.showPassword=!1,this.email="",this.emailPattern="^[^\\s@]+@lau\\.edu(?:\\.lb)?$",this.rememberMe=!1}togglePasswordVisibility(){this.showPassword=!this.showPassword}ngOnInit(){this.autoLogin()}autoLogin(){const o=localStorage.getItem("rememberToken");o&&this.authService.autoLogin(o).subscribe({next:t=>{console.log("Auto login successful:",t);const r=localStorage.getItem("user_type");this.fcmService.initializePushNotifications(),"1"==r&&this.router.navigate(["./tabs/report-emergency"]),"2"==r&&this.router.navigate(["./report"])},error:t=>{console.error("Error auto logging in:",t)}})}login(){this.email&&this.password?this.email.match(this.emailPattern)?this.authService.login(this.email,this.password,this.rememberMe).subscribe(o=>{const t=JSON.parse(JSON.stringify(o));console.log("Response: ",t),console.log("Remember me: ",this.rememberMe),"Invalid credentials"===t.status?this.presentToast("Incorrect email or password"):"Login attempts exceeded"===t.status?this.presentToast("Login attempts limit reached. Try again in 24 hours."):"Login successful"===t.status&&(localStorage.setItem("user_id",t.user_id),localStorage.setItem("first_name",t.first_name),localStorage.setItem("last_name",t.last_name),localStorage.setItem("lau_email",t.lau_email),localStorage.setItem("profile_picture",t.profile_picture),localStorage.setItem("user_type",t.user_type),localStorage.setItem("auth_token",t.token),1==t.user_type?(localStorage.setItem("rank",t.rank.rank_name),this.router.navigate(["/tabs/report-emergency"]),console.log(localStorage)):2==t.user_type&&(this.router.navigate(["report"]),console.log(localStorage)),this.fcmService.initializePushNotifications(),this.appComponent.ngOnInit())}):this.presentToast("Invalid LAU email"):this.presentToast("Email and password cannot be empty")}presentToast(o){var t=this;return(0,p.Z)(function*(){(yield t.toastController.create({message:o,duration:2e3,position:"bottom"})).present()})()}navigateRegister(){this.router.navigate(["/register"])}}return(n=s).\u0275fac=function(o){return new(o||n)(e.Y36(h.e),e.Y36(d.F0),e.Y36(a.yF),e.Y36(f.y),e.Y36(P.E))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-login"]],decls:24,vars:6,consts:[["mode","ios",1,"background"],[1,"main-container"],[1,"logo-block"],["src","/assets/img/logo.png",1,"logo"],[1,"curved-shape"],[1,"statement-container"],[1,"forms-container"],["lines","none"],["type","email","placeholder","Email","required","",3,"ngModel","pattern","ngModelChange"],["name","mail-outline","slot","start"],["placeholder","Password","required","",3,"type","ngModel","ngModelChange"],["name","lock-closed","slot","start"],["slot","end",3,"name","click"],["labelPlacement","end",3,"ngModel","ngModelChange"],[3,"click"],["slot","start","name","log-in-outline"],[1,"no-account-text",3,"click"]],template:function(o,t){1&o&&(e.TgZ(0,"ion-content",0)(1,"div",1)(2,"div",2),e._UZ(3,"img",3),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"h1"),e._uU(7,"Login with your LAU email"),e.qZA()(),e.TgZ(8,"div",6)(9,"ion-list")(10,"ion-item",7)(11,"ion-input",8),e.NdJ("ngModelChange",function(l){return t.email=l}),e._UZ(12,"ion-icon",9),e.qZA()(),e.TgZ(13,"ion-item",7)(14,"ion-input",10),e.NdJ("ngModelChange",function(l){return t.password=l}),e._UZ(15,"ion-icon",11),e.TgZ(16,"ion-icon",12),e.NdJ("click",function(){return t.togglePasswordVisibility()}),e.qZA()()()(),e.TgZ(17,"ion-checkbox",13),e.NdJ("ngModelChange",function(l){return t.rememberMe=l}),e._uU(18,"Keep me signed in"),e.qZA(),e.TgZ(19,"ion-button",14),e.NdJ("click",function(){return t.login()}),e._UZ(20,"ion-icon",15),e._uU(21," Login "),e.qZA(),e.TgZ(22,"h6",16),e.NdJ("click",function(){return t.navigateRegister()}),e._uU(23,"Don't have an account?"),e.qZA()()()()()),2&o&&(e.xp6(11),e.Q6J("ngModel",t.email)("pattern",t.emailPattern),e.xp6(3),e.Q6J("type",t.showPassword?"text":"password")("ngModel",t.password),e.xp6(2),e.Q6J("name",t.showPassword?"eye-off":"eye"),e.xp6(),e.Q6J("ngModel",t.rememberMe))},dependencies:[g.JJ,g.Q7,g.c5,g.On,a.YG,a.nz,a.W2,a.gu,a.pK,a.Ie,a.q_,a.w,a.j9],styles:[".background[_ngcontent-%COMP%]{--ion-background-color:#FFEDED}.main-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-between;height:100%}.logo-block[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:-moz-fit-content;height:fit-content;width:-moz-fit-content;width:fit-content;width:100%;height:25%}.logo[_ngcontent-%COMP%]{width:50%}.curved-shape[_ngcontent-%COMP%]{width:100%;height:75%;bottom:0;background:linear-gradient(to top,#ffeded,#810808);clip-path:ellipse(140% 100% at 35% 100%);padding-top:3em}.statement-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;padding-left:2em;width:60%;color:#fff}.forms-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:space-evenly;height:55%;width:100%}ion-list[_ngcontent-%COMP%]{background-color:transparent;width:100%}ion-item[_ngcontent-%COMP%]{--background: transparent;margin:10px}ion-select[_ngcontent-%COMP%]{padding-left:1em;padding-right:1em;border-radius:25px;height:52px;background:#ffeded;color:#000;--placeholder-color: #464141}ion-input[_ngcontent-%COMP%]{border-radius:25px;height:52px;background:#ffeded;color:#000;--placeholder-color: #464141}ion-icon[name=lock-closed][_ngcontent-%COMP%], ion-icon[name=mail-outline][_ngcontent-%COMP%]{padding-left:.5em;font-size:25px;color:#464141}ion-icon[name=eye][_ngcontent-%COMP%], ion-icon[name=eye-off][_ngcontent-%COMP%]{padding-right:.5em;font-size:1.5em;color:#464141}ion-checkbox[_ngcontent-%COMP%]{--size: 32px;margin-top:1em;margin-bottom:1em;--checkbox-background-checked: #810808;--border-color-checked: #810808;--checkbox-background: white;--border-color: gray;color:#000}ion-checkbox[_ngcontent-%COMP%]::part(container){border-radius:6px}ion-button[_ngcontent-%COMP%]{width:40%;--background: #FFEDED;--color: black;border-radius:15px;box-shadow:0 4px 4px #00000059;--background-activated: #810808;--background-activated-opacity: .9;--color-activated: white}.no-account-text[_ngcontent-%COMP%]{color:#000;text-decoration:underline}.no-account-text[_ngcontent-%COMP%]:active{color:#810808}"]}),s})()}];let M=(()=>{var n;class s{}return(n=s).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[d.Bz.forChild(b),d.Bz]}),s})(),v=(()=>{var n;class s{}return(n=s).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.ez,g.u5,a.Pc,M]}),s})()}}]);