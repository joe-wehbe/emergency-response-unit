"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1988],{1988:(R,_,l)=>{l.r(_),l.d(_,{AttendanceRecordsPageModule:()=>v});var p=l(6814),f=l(6223),c=l(451),m=l(8179),b=l(5861),t=l(9212),M=l(82);function x(n,r){if(1&n){const i=t.EpF();t.TgZ(0,"div",19)(1,"div",20)(2,"p",21),t._uU(3,"Please select a month"),t.qZA()(),t.TgZ(4,"ion-datetime",22),t.NdJ("ngModelChange",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.selectedMonth=o)})("ionChange",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.onMonthChange(o))}),t.qZA(),t.TgZ(5,"div",23)(6,"ion-button",24),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.dismiss())}),t._uU(7,"Cancel"),t.qZA(),t.TgZ(8,"ion-button",25),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.fetch())}),t._uU(9,"View records"),t.qZA()()()}if(2&n){const i=t.oxw();t.xp6(4),t.Q6J("ngModel",i.selectedMonth)}}const A=n=>({color:n});function y(n,r){if(1&n&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td",28),t._uU(8),t.qZA()()),2&n){const i=r.$implicit;t.xp6(2),t.Oqu(i.timeRange),t.xp6(2),t.Oqu(i.name),t.xp6(2),t.Oqu(i.coveredBy),t.xp6(),t.Q6J("ngStyle",t.VKq(5,A,"yes"===i.isAttended?"green":"no"===i.isAttended?"red":"")),t.xp6(),t.Oqu(i.isAttended)}}function P(n,r){if(1&n&&(t.TgZ(0,"div")(1,"ion-list-header")(2,"p",26),t._uU(3),t.qZA()(),t.TgZ(4,"ion-card")(5,"table",27)(6,"thead")(7,"tr")(8,"th"),t._uU(9,"Shift"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Name"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Covered By"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Attended"),t.qZA()()(),t.TgZ(16,"tbody"),t.YNc(17,y,9,7,"tr",15),t.qZA()()()()),2&n){const i=r.$implicit,e=t.oxw();t.xp6(3),t.Oqu(i),t.xp6(14),t.Q6J("ngForOf",e.groupedShifts[i])}}const C=[{path:"",component:(()=>{var n;class r{constructor(e,o,s){this.router=e,this.modalController=o,this.adminService=s,this.allShifts=[],this.shifts=[],this.groupedShifts={},this.selectedMonth="",this.Object=Object,this.selectedMonth=this.getCurrentMonth(),this.adminService.getAttendanceRecords().subscribe({next:a=>{console.log("Fetched shifts:",a);const g=JSON.parse(JSON.stringify(a));this.allShifts=[].concat.apply([],Object.values(g.shifts)),this.allShifts.forEach(u=>{})},error:a=>{console.error("Error applying:",a)}}),this.shifts=[{name:"Joe Wehbe",coveredBy:"Roula Ghaleb",date:"22/04/2024",timeRange:"9:00 - 10:00",isAttended:"yes"}],this.groupedShifts=this.groupShiftsByDate(this.shifts)}ngOnInit(){this.fetch()}back(){this.router.navigate(["/admin-panel"])}dismiss(){this.modalController.dismiss()}onMonthChange(e){this.selectedMonth=e.detail.value}getCurrentMonth(){const e=new Date;return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}`}fetch(){var e=this;return(0,b.Z)(function*(){if(e.selectedMonth){const[o,s]=e.selectedMonth.split("-"),a=e.shifts.filter(g=>{const[u,d,h]=g.date.split("/");return d===s&&h===o});e.groupedShifts=e.groupShiftsByDate(a)}yield e.modalController.dismiss()})()}search(e){const o=e.target.value.trim();this.groupedShifts=this.groupShiftsByDate(this.shifts.filter(""===o?s=>{const[a,g]=this.selectedMonth.split("-"),[u,d,h]=s.date.split("/");return d===g&&h===a}:s=>{const[a,g]=this.selectedMonth.split("-"),[u,d,h]=s.date.split("/");return d===g&&h===a&&s.date.includes(o)}))}groupShiftsByDate(e){const o={},s=["8:00 - 9:00","9:00 - 10:00","10:00 - 11:00","11:00 - 12:00","12:00 - 13:00","13:00 - 14:00","14:00 - 15:00","15:00 - 16:00"];return e.forEach(a=>{o[a.date]||(o[a.date]=[]),o[a.date].push(a)}),Object.keys(o).forEach(a=>{const u=o[a].map(d=>d.timeRange);s.forEach(d=>{u.includes(d)||o[a].push({name:"-",coveredBy:"-",date:a,timeRange:d,isAttended:"-"})}),o[a].sort((d,h)=>{const O=d.timeRange.split(" - ")[0],T=h.timeRange.split(" - ")[0];return new Date("1970/01/01 "+O).getTime()-new Date("1970/01/01 "+T).getTime()})}),o}}return(n=r).\u0275fac=function(e){return new(e||n)(t.Y36(m.F0),t.Y36(c.IN),t.Y36(M.l))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-attendance-records"]],decls:21,vars:2,consts:[["id","main-content"],[1,"header-toolbar"],[1,"toolbar-container"],["slot","start"],[3,"click"],["name","chevron-back-outline",1,"back-button"],[1,"title"],["name","calendar-outline","id","select-time",1,"calendar-button"],["mode","ios","id","select-time-modal","trigger","select-time"],["modal",""],[1,"background"],[1,"search-bar-container"],["mode","md","placeholder","Search date...",1,"search-bar",3,"debounce","ionInput"],["searchBar",""],[1,"container"],[4,"ngFor","ngForOf"],["vertical","bottom","horizontal","end","slot","fixed"],["id","add-announcement"],["name","download-outline",1,"download-icon"],[1,"wrapper"],[1,"stmt"],[1,"section"],["presentation","month-year","id","date",3,"ngModel","ngModelChange","ionChange"],[1,"buttons-container"],["fill","outline",1,"cancel-button",3,"click"],["fill","outline",1,"fetch-button",3,"click"],[1,"date"],[1,"table"],[3,"ngStyle"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"div",2)(3,"ion-buttons",3)(4,"ion-button",4),t.NdJ("click",function(){return o.back()}),t._UZ(5,"ion-icon",5),t.qZA()(),t.TgZ(6,"ion-title",6),t._uU(7,"Attendance Records"),t.qZA(),t._UZ(8,"ion-icon",7),t.qZA()(),t.TgZ(9,"ion-modal",8,9),t.YNc(11,x,10,1,"ng-template"),t.qZA()(),t.TgZ(12,"ion-content",10)(13,"div",11)(14,"ion-searchbar",12,13),t.NdJ("ionInput",function(a){return o.search(a)}),t.qZA()(),t.TgZ(16,"div",14),t.YNc(17,P,18,2,"div",15),t.qZA(),t.TgZ(18,"ion-fab",16)(19,"ion-fab-button",17),t._UZ(20,"ion-icon",18),t.qZA()()()),2&e&&(t.xp6(14),t.Q6J("debounce",800),t.xp6(3),t.Q6J("ngForOf",o.Object.keys(o.groupedShifts)))},dependencies:[p.sg,p.PC,f.JJ,f.On,c.YG,c.Sm,c.PM,c.W2,c.x4,c.IJ,c.W4,c.Gu,c.gu,c.yh,c.VI,c.wd,c.sr,c.ki,c.QI,c.j9],styles:[".header-toolbar[_ngcontent-%COMP%]{height:60px;display:flex;justify-content:center;align-items:center}.toolbar-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding:5px}.back-button[_ngcontent-%COMP%]{font-weight:400}.title[_ngcontent-%COMP%]{font-size:22px;font-weight:400}.calendar-button[_ngcontent-%COMP%]{width:20%;font-size:25px}.search-bar-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:1.2em}ion-searchbar.search-bar[_ngcontent-%COMP%]{padding:0 10px;border:solid 1px;border-radius:20px;--background: transparent;--box-shadow: none}ion-modal#select-time-modal[_ngcontent-%COMP%]{--width: 96%;--min-width: 250px;--height: fit-content;--border-radius: 6px;--box-shadow: 0 28px 48px rgba(0, 0, 0, .4)}ion-modal#select-time-modal[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}.stmt[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:18px;font-weight:700}ion-datetime[_ngcontent-%COMP%]{--wheel-fade-background-rgb: none;--background: transparent;margin:10px}.buttons-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:10px;width:100%}.fetch-button[_ngcontent-%COMP%]{--border-color: #810808;--background-activated: #810808;--color-activated: white;width:50%}.cancel-button[_ngcontent-%COMP%]{--background-activated: #810808;--color-activated: white;width:50%}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;padding-bottom:10px}ion-list-header[_ngcontent-%COMP%]{font-weight:400;font-size:16px;margin:0;font-weight:700}.date[_ngcontent-%COMP%]{margin:0}ion-card[_ngcontent-%COMP%]{margin:0 1em}table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #dddddd;text-align:left;padding:8px}ion-fab-button[_ngcontent-%COMP%]{--background: #810808;--color: white;--background-activated: #380404;margin:5px}"]}),r})()}];let Z=(()=>{var n;class r{}return(n=r).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.Bz.forChild(C),m.Bz]}),r})(),v=(()=>{var n;class r{}return(n=r).\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,f.u5,c.Pc,Z]}),r})()}}]);